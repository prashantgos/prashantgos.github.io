(function($){$.fn.shorten=function(settings){var config={showChars:100,ellipsesText:"...",moreText:"more",lessText:"less"};if(settings){$.extend(config,settings);}$(document).off("click",'.morelink');$(document).on({click:function(){var $this=$(this);if($this.hasClass('less')){$this.removeClass('less');$this.html(config.moreText);$this.parent().prev().prev().show();$this.parent().prev().hide();}else{$this.addClass('less');$this.html(config.lessText);$this.parent().prev().prev().hide();$this.parent().prev().show();}return false;}},'.morelink');return this.each(function(){var $this=$(this);var content=$this.html();var contentlength=$this.text();if(contentlength.length>config.showChars){var c=content.substr(0,config.showChars);if(c.indexOf('<')>=0){var inTag=false;var bag='';var countChars=0;var openTags=[];for(i=0;i<content.length;i++){if(content[i]=='<'&&!inTag){inTag=true;tagName=content.substring(i+1,content.indexOf('>',i));if(tagName[0]=='/'){if(tagName!='/'+openTags[0]);else
openTags.shift();}else{if(tagName.toLowerCase()!='br')openTags.unshift(tagName);}}if(inTag&&content[i]=='>'){inTag=false;}if(inTag)bag+=content[i];else{if(countChars<config.showChars){bag+=content[i];countChars++;}else{if(openTags.length>0){for(j=0;j<openTags.length;j++){bag+='</'+openTags[j]+'>';}break;}}}}c=bag;}var html='<span class="shortcontent">'+c+'&nbsp;'+config.ellipsesText+'</span><span class="allcontent">'+content+'</span>&nbsp;&nbsp;<span><a href="javascript://nop/" class="morelink">'+config.moreText+'</a></span>';$this.html(html);$(".allcontent").hide();}});};})(jQuery);$(".comment").shorten({"showChars":150,"moreText":"See More","lessText":"Less",});